<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="format-detection" content="telephone=no"/>
    <meta name="viewport"
          content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi"/>
    <script src="css/source-sans-pro.js"></script>
    <link rel="stylesheet" type="text/css" href="css/index.css"/>
    <title>BIG Register Check</title>
</head>
<body>

<script type="text/javascript" src="phonegap.js"></script>
<script src="lib/jquery-1.9.1.min.js"></script>
<script src="lib/soapclient.js"></script>
<script type="text/javascript" src="js/index.js"></script>
<script type="text/javascript">
    "use strict";

    var url = "http://webservices-acc.cibg.nl/Ribiz/OpenbaarV2.asmx";
    var soapaction = "http://services.cibg.nl/ExternalUser/ListHcpApprox3";

    alert("Start");

    var sr = '<?xml version="1.0" encoding="utf-8"?>' +
            '<soap:Envelope ' +
            'xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" ' +
            'xmlns:xsd="http://www.w3.org/2001/XMLSchema" ' +
            'xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  ' +
            '<soap:Body>' +
            '<listHcpApproxRequest xmlns="http://services.cibg.nl/ExternalUser">' +
            '<WebSite>Ribiz</WebSite>' +
            '<Name>Hak</Name>' +
            '<Initials>C.H.</Initials>' +
            '</listHcpApproxRequest>' +
            '</soap:Body>' +
            '</soap:Envelope>';
    alert(sr);

    var xmlHttpRequest = new XMLHttpRequest();
    xmlHttpRequest.open("POST", url, true);
    xmlHttpRequest.setRequestHeader("SOAPAction", soapaction);
    xmlHttpRequest.setRequestHeader("Content-Type", "text/xml; charset=utf-8");
    xmlHttpRequest.send(sr);

    function processResult() {
        if (xmlHttpRequest.readyState == null || xmlHttpRequest.readyState == "undefined") {
            xmlHttpRequest.readyState = 1;
            xmlHttpRequest.addEventListener("load",
                    function () {
                        xmlHttpRequest.readyState = 4;
                        if (typeof xmlHttpRequest.onreadystatechange == "function")
                            xmlHttpRequest.onreadystatechange();
                    },
                    false);
        }


        if (xmlHttpRequest.readyState == 4) {
            $('body').append(xmlHttpRequest.response);
            alert("XmlHttp status: " + xmlHttpRequest.status);
            alert("XmlHttp readyState: " + xmlHttpRequest.readyState);
            alert("Response headers: " + xmlHttpRequest.getAllResponseHeaders());
            alert("Response XML: " + xmlHttpRequest.responseXML);
        }
    };

    xmlHttpRequest.onreadystatechange = processResult;

</script>
</body>
</html>
